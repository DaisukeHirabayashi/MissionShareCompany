{"remainingRequest":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue","mtime":1573698790798},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vuetify-loader/lib/loader.js","mtime":1564062719000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7CmltcG9ydCBmaXJlYmFzZSBmcm9tICJmaXJlYmFzZSI7CmltcG9ydCBObDJiciBmcm9tICJ2dWUtbmwyYnIiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBObDJiciB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiB7fSwgLy8g44Om44O844K244O85oOF5aCxCiAgICAgIGNoYXQ6IFtdLCAvLyDlj5blvpfjgZfjgZ/jg6Hjg4Pjgrvjg7zjgrjjgpLlhaXjgozjgovphY3liJcKICAgICAgaW5wdXQ6ICIiIC8vIOWFpeWKm+OBl+OBn+ODoeODg+OCu+ODvOOCuAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBmaXJlYmFzZS5hdXRoKCkub25BdXRoU3RhdGVDaGFuZ2VkKHVzZXIgPT4gewogICAgICB0aGlzLnVzZXIgPSB1c2VyID8gdXNlciA6IHt9OwogICAgICB0aGlzLmNoYXQgPSBbXTsKICAgICAgY29uc3QgcmVmX21lc3NhZ2UgPSBmaXJlYmFzZQogICAgICAgIC5kYXRhYmFzZSgpCiAgICAgICAgLnJlZigiY29tbWVudC8iICsgdGhpcy4kc3RvcmUuc3RhdGUuY29tcGFueS5rZXkpOwogICAgICByZWZfbWVzc2FnZS5saW1pdFRvTGFzdCgxMDApLm9uKCJjaGlsZF9hZGRlZCIsIHRoaXMuY2hpbGRBZGRlZCk7CiAgICB9KTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSh7CiAgICAgIGNvbXBhbnk6ICJjb21wYW55IgogICAgfSkKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoaWxkQWRkZWQoc25hcCkgewogICAgICBjb25zdCBtZXNzYWdlID0gc25hcC52YWwoKTsKICAgICAgdGhpcy5jaGF0LnB1c2goewogICAgICAgIGtleTogc25hcC5rZXksCiAgICAgICAgbmFtZTogbWVzc2FnZS5uYW1lLAogICAgICAgIGltYWdlOiBtZXNzYWdlLmltYWdlLAogICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UubWVzc2FnZSwKICAgICAgICBjb21wYW55a2V5OiBtZXNzYWdlLmNvbXBhbnlrZXkKICAgICAgfSk7CiAgICB9LAogICAgZG9TZW5kKHNlbmRrZXkpIHsKICAgICAgaWYgKHRoaXMudXNlci51aWQgJiYgdGhpcy5pbnB1dC5sZW5ndGgpIHsKICAgICAgICAvLyBmaXJlYmFzZSDjgavjg6Hjg4Pjgrvjg7zjgrjjgpLov73liqAKICAgICAgICBmaXJlYmFzZQogICAgICAgICAgLmRhdGFiYXNlKCkKICAgICAgICAgIC5yZWYoImNvbW1lbnQvIiArIHNlbmRrZXkpCiAgICAgICAgICAucHVzaCgKICAgICAgICAgICAgewogICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuaW5wdXQsCiAgICAgICAgICAgICAgbmFtZTogdGhpcy51c2VyLmRpc3BsYXlOYW1lLAogICAgICAgICAgICAgIGltYWdlOiB0aGlzLnVzZXIucGhvdG9VUkwsCiAgICAgICAgICAgICAgY29tcGFueWtleTogc2VuZGtleQogICAgICAgICAgICB9LAogICAgICAgICAgICAoKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5pbnB1dCA9ICIiOyAvLyDjg5Xjgqnjg7zjg6DjgpLnqbrjgavjgZnjgosKICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgfQogICAgfSwKICAgIG1vdmVVcmwodXJsKSB7CiAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSB1cmw7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"detail\">\n    <h2>詳細ページ</h2>\n    <div>会社名:{{ company.name }}</div>\n    <div>本社:{{ company.prefecture }}</div>\n    <div>住所:{{ company.address }}</div>\n    <div>電話番号:{{ company.phonenumber }}</div>\n    <a href=\"#\" @click=\"moveUrl(company.url)\">{{ company.url }}</a>\n    <br />\n    <h3>~みんなのコメント~</h3>\n    <!--Firebase から取得したリストを描画（トランジション付き）-->\n    <transition-group name=\"chat\" tag=\"div\" class=\"list content\">\n      <section\n        v-for=\"{ key, name, image, message, companykey } in chat\"\n        :key=\"key\"\n      >\n        <div v-if=\"company.key == companykey\" key=\"chat\" class=\"box11\">\n          <div class=\"item-detail\">\n            <div class=\"item-name\">{{ name }}</div>\n            <div class>\n              {{ message }}\n            </div>\n          </div>\n        </div>\n      </section> </transition-group\n    >\u0010\n\n    <!-- 入力フォーム -->\n    <form action=\"\" @submit.prevent=\"doSend(company.key)\" class=\"form\">\n      <textarea\n        v-model=\"input\"\n        :disabled=\"!user.uid\"\n        placeholder=\"コメントを残す\"\n      ></textarea>\n      <button type=\"submit\" :disabled=\"!user.uid\" class=\"send-button\">\n        Send\n      </button>\n    </form>\n  </div>\n</template>\n<script>\nimport { mapState } from \"vuex\";\nimport firebase from \"firebase\";\nimport Nl2br from \"vue-nl2br\";\nexport default {\n  components: { Nl2br },\n  data() {\n    return {\n      user: {}, // ユーザー情報\n      chat: [], // 取得したメッセージを入れる配列\n      input: \"\" // 入力したメッセージ\n    };\n  },\n  created() {\n    firebase.auth().onAuthStateChanged(user => {\n      this.user = user ? user : {};\n      this.chat = [];\n      const ref_message = firebase\n        .database()\n        .ref(\"comment/\" + this.$store.state.company.key);\n      ref_message.limitToLast(100).on(\"child_added\", this.childAdded);\n    });\n  },\n  computed: {\n    ...mapState({\n      company: \"company\"\n    })\n  },\n  methods: {\n    childAdded(snap) {\n      const message = snap.val();\n      this.chat.push({\n        key: snap.key,\n        name: message.name,\n        image: message.image,\n        message: message.message,\n        companykey: message.companykey\n      });\n    },\n    doSend(sendkey) {\n      if (this.user.uid && this.input.length) {\n        // firebase にメッセージを追加\n        firebase\n          .database()\n          .ref(\"comment/\" + sendkey)\n          .push(\n            {\n              message: this.input,\n              name: this.user.displayName,\n              image: this.user.photoURL,\n              companykey: sendkey\n            },\n            () => {\n              this.input = \"\"; // フォームを空にする\n            }\n          );\n      }\n    },\n    moveUrl(url) {\n      document.location.href = url;\n    }\n  }\n};\n</script>\n"]}]}