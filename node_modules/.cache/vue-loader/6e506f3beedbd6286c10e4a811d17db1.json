{"remainingRequest":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/k17111kk/TechTrain/techTrain_mission/src/views/Delete.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/k17111kk/TechTrain/techTrain_mission/src/views/Delete.vue","mtime":1575350812744},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vuetify-loader/lib/loader.js","mtime":1564062719000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGZpcmViYXNlIOODouOCuOODpeODvOODqwppbXBvcnQgZmlyZWJhc2UgZnJvbSAiZmlyZWJhc2UiOwppbXBvcnQgeyBtYXBTdGF0ZSwgbWFwTXV0YXRpb25zIH0gZnJvbSAidnVleCI7CmltcG9ydCB7IENPTVBBTllfVVBEQVRFIH0gZnJvbSAiLi4vc3RvcmUvbXV0YXRpb24tdHlwZXMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImRlbGV0ZSIsCiAgY29tcG9uZW50czogewogICAgVnVlTG9hZGluZwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXI6IHt9LCAvLyDjg6bjg7zjgrbjg7zmg4XloLEKICAgICAgY29tcGFueXM6IFtdLCAvLyDlj5blvpfjgZfjgZ/mnKznpL7jgpLlhaXjgozjgovphY3liJcKICAgICAgc3ViQ29tcGFueXM6IFtdLAogICAgICBpbnB1dDogIiIsIC8vIOWFpeWKm+OBl+OBn+ODoeODg+OCu+ODvOOCuAogICAgICBsb2FkaW5nOiB0cnVlCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGZpcmViYXNlLmF1dGgoKS5vbkF1dGhTdGF0ZUNoYW5nZWQodXNlciA9PiB7CiAgICAgIHRoaXMudXNlciA9IHVzZXIgPyB1c2VyIDoge307CiAgICAgIGNvbnN0IGNvbXBhbnlEYXRhID0gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoIm1haW4tY29tcGFueSIpOwogICAgICBjb25zdCBzdWJDb21wYW55RGF0YSA9IGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCJzdWItY29tcGFueSIpOwogICAgICBpZiAodXNlcikgewogICAgICAgIHRoaXMuY29tcGFueXMgPSBbXTsKICAgICAgICB0aGlzLnN1YkNvbXBhbnlzID0gW107CiAgICAgICAgLy8gY29tcGFueSDjgavlpInmm7TjgYzjgYLjgaPjgZ/jgajjgY3jga7jg4/jg7Pjg4njg6njgpLnmbvpjLIKICAgICAgICBjb21wYW55RGF0YS5saW1pdFRvTGFzdCgxMDApLm9uKCJjaGlsZF9hZGRlZCIsIHRoaXMuY2hpbGRBZGRlZCk7CiAgICAgICAgc3ViQ29tcGFueURhdGEubGltaXRUb0xhc3QoMTAwKS5vbigiY2hpbGRfYWRkZWQiLCB0aGlzLnN1YkNoaWxkQWRkZWQpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGNvbXBhbnkg44Gr5aSJ5pu044GM44GC44Gj44Gf44Go44GN44Gu44OP44Oz44OJ44Op44KS6Kej6ZmkCiAgICAgICAgY29tcGFueURhdGEubGltaXRUb0xhc3QoMTAwKS5vZmYoImNoaWxkX2FkZGVkIiwgdGhpcy5jaGlsZEFkZGVkKTsKICAgICAgICBzdWJDb21wYW55RGF0YS5saW1pdFRvTGFzdCgxMDApLm9mZigiY2hpbGRfYWRkZWQiLCB0aGlzLnN1YkNoaWxkQWRkZWQpOwogICAgICB9CiAgICB9KTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICB9LCAxMDAwKTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmaWx0ZXJlZENvbXBhbnlzOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGZpbHRlckNvbXBhbnlzID0gW107CiAgICAgIHZhciB1c2VyX3VpZCA9IHRoaXMudXNlci51aWQ7CiAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5jb21wYW55cykgewogICAgICAgIHZhciBjb21wYW55ID0gdGhpcy5jb21wYW55c1tpXTsKICAgICAgICBpZiAodXNlcl91aWQgPT0gY29tcGFueS51c2VyX2lkKSB7CiAgICAgICAgICBmaWx0ZXJDb21wYW55cy5wdXNoKGNvbXBhbnkpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmlsdGVyQ29tcGFueXM7CiAgICB9LAogICAgZmlsdGVyZWRTdWJDb21wYW55czogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBmaWx0ZXJDb21wYW55cyA9IFtdOwogICAgICB2YXIgdXNlcl91aWQgPSB0aGlzLnVzZXIudWlkOwogICAgICBmb3IgKHZhciBpIGluIHRoaXMuc3ViQ29tcGFueXMpIHsKICAgICAgICB2YXIgY29tcGFueSA9IHRoaXMuc3ViQ29tcGFueXNbaV07CiAgICAgICAgaWYgKHVzZXJfdWlkID09IGNvbXBhbnkudXNlcl9pZCkgewogICAgICAgICAgZmlsdGVyQ29tcGFueXMucHVzaChjb21wYW55KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZpbHRlckNvbXBhbnlzOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g44K544Kv44Ot44O844Or5L2N572u44KS5LiA55Wq5LiL44Gr56e75YuVCiAgICAuLi5tYXBNdXRhdGlvbnMoewogICAgICBDT01QQU5ZX1VQREFURQogICAgfSksCiAgICBzY3JvbGxCb3R0b20oKSB7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDlj5fjgZHlj5bjgaPjgZ/jg6Hjg4Pjgrvjg7zjgrjjgpJjb21wYW55c+OBq+i/veWKoAogICAgLy8g44OH44O844K/44OZ44O844K544Gr5paw44GX44GE6KaB57Sg44GM6L+95Yqg44GV44KM44KL44Go6ZqP5pmC5ZG844Gz5Ye644GV44KM44KLCiAgICBjaGlsZEFkZGVkKHNuYXApIHsKICAgICAgY29uc3QgY29tcGFueSA9IHNuYXAudmFsKCk7CiAgICAgIHRoaXMuY29tcGFueXMucHVzaCh7CiAgICAgICAga2V5OiBzbmFwLmtleSwKICAgICAgICBuYW1lOiBjb21wYW55Lm5hbWUsCiAgICAgICAgcHJlZmVjdHVyZTogY29tcGFueS5wcmVmZWN0dXJlLAogICAgICAgIGFkZHJlc3M6IGNvbXBhbnkuYWRkcmVzcywKICAgICAgICB1cmw6IGNvbXBhbnkudXJsLAogICAgICAgIHBob25lbnVtYmVyOiBjb21wYW55LnBob25lbnVtYmVyLAogICAgICAgIHVzZXJfaWQ6IGNvbXBhbnkudXNlcl9pZAogICAgICB9KTsKICAgICAgdGhpcy5zY3JvbGxCb3R0b20oKTsKICAgIH0sCiAgICBzdWJDaGlsZEFkZGVkKHNuYXApIHsKICAgICAgY29uc3Qgc3ViQ29tcGFueSA9IHNuYXAudmFsKCk7CiAgICAgIHRoaXMuc3ViQ29tcGFueXMucHVzaCh7CiAgICAgICAga2V5OiBzbmFwLmtleSwKICAgICAgICBuYW1lOiBzdWJDb21wYW55Lm5hbWUsCiAgICAgICAgcHJlZmVjdHVyZTogc3ViQ29tcGFueS5wcmVmZWN0dXJlLAogICAgICAgIGFkZHJlc3M6IHN1YkNvbXBhbnkuYWRkcmVzcywKICAgICAgICB1cmw6IHN1YkNvbXBhbnkudXJsLAogICAgICAgIHBob25lbnVtYmVyOiBzdWJDb21wYW55LnBob25lbnVtYmVyLAogICAgICAgIG1haW5fY29tX2lkOiBzdWJDb21wYW55Lm1haW5fY29tX2lkLAogICAgICAgIHVzZXJfaWQ6IHN1YkNvbXBhbnkudXNlcl9pZAogICAgICB9KTsKICAgICAgdGhpcy5zY3JvbGxCb3R0b20oKTsKICAgIH0sCiAgICBkZWxldGVNYWluQ29tcGFueShrZXkpIHsKICAgICAgdmFyIHJlcyA9IGNvbmZpcm0oIuacrOW9k+OBq+WJiumZpOOBl+OBvuOBmeOBiz8iKTsKICAgICAgaWYgKHJlcyA9PSB0cnVlKSB7CiAgICAgICAgZmlyZWJhc2UKICAgICAgICAgIC5kYXRhYmFzZSgpCiAgICAgICAgICAucmVmKCJtYWluLWNvbXBhbnkvIiArIGtleSkKICAgICAgICAgIC5zZXQoe30pOyAvL+S8muekvuaDheWgseOBruWJiumZpAogICAgICAgIGZpcmViYXNlCiAgICAgICAgICAuZGF0YWJhc2UoKQogICAgICAgICAgLnJlZigiY29tbWVudC8iICsga2V5KQogICAgICAgICAgLnNldCh7fSk7IC8v44GC44KL5Lya56S+44Gr5a++44GZ44KL44Kz44Oh44Oz44OI44Gu5YmK6ZmkCiAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7CiAgICAgIH0KICAgIH0sCiAgICBkZWxldGVTdWJDb21wYW55KGtleSkgewogICAgICB2YXIgcmVzID0gY29uZmlybSgi5pys5b2T44Gr5YmK6Zmk44GX44G+44GZ44GLPyIpOwogICAgICBpZiAocmVzID09IHRydWUpIHsKICAgICAgICBmaXJlYmFzZQogICAgICAgICAgLmRhdGFiYXNlKCkKICAgICAgICAgIC5yZWYoInN1Yi1jb21wYW55LyIgKyBrZXkpCiAgICAgICAgICAuc2V0KHt9KTsgLy/kvJrnpL7mg4XloLHjga7liYrpmaQKICAgICAgICBmaXJlYmFzZQogICAgICAgICAgLmRhdGFiYXNlKCkKICAgICAgICAgIC5yZWYoImNvbW1lbnQvIiArIGtleSkKICAgICAgICAgIC5zZXQoe30pOyAvL+OBguOCi+S8muekvuOBq+WvvuOBmeOCi+OCs+ODoeODs+ODiOOBruWJiumZpAogICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpOwogICAgICB9CiAgICB9LAogICAgc2VuZERldGFpbCgpIHsKICAgICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9ICIuL2RldGFpbCI7CiAgICB9LAogICAgY29tcGFueVNlbmQoc3RyKSB7CiAgICAgIHRoaXMuQ09NUEFOWV9VUERBVEUoc3RyKTsgLy/kvJrnpL7mg4XloLHjgpLoqbPntLDnlLvpnaLjgavpgIHjgosKICAgICAgdGhpcy5zZW5kRGV0YWlsKCk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Delete.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Delete.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"delete\">\n    <div id=\"app\">\n      <template v-if=\"this.loading\">\n        <vue-loading\n          type=\"balls\"\n          color=\"#333\"\n          :size=\"{ width: '50px', height: '50px' }\"\n        ></vue-loading>\n      </template>\n      <template v-else>\n        <v-container class=\"mx-auto text-left p-3\">\n          <h3 class=\"p-3\">会社削除ページ</h3>\n          <!--Firebase から取得したリストを描画（トランジション付き）-->\n          <template v-if=\"filteredCompanys == '' && filteredSubCompanys == ''\">\n            <a>あなたが登録した企業は見つかりませんでした</a>\n          </template>\n          <template v-else>\n            <h4>本社</h4>\n            <v-list two-line subheader shaped>\n              <v-subheader>COMPANYS</v-subheader>\n              <v-list-item-group color=\"primary\">\n                <v-list-item\n                  v-for=\"{\n                    key,\n                    name,\n                    prefecture,\n                    address,\n                    url,\n                    phonenumber,\n                    user_id,\n                    type\n                  } in filteredCompanys\"\n                >\n                  <v-list-item-content @click=\"deleteMainCompany(key)\">\n                    <v-list-item-title\n                      style=\"text-align: left;\"\n                      class=\"ml-4\"\n                      v-text=\"prefecture\"\n                    ></v-list-item-title>\n                    <v-list-item-subtitle\n                      style=\"text-align: left;\"\n                      class=\"ml-4\"\n                      v-text=\"name\"\n                    ></v-list-item-subtitle>\n                  </v-list-item-content>\n                </v-list-item>\n              </v-list-item-group>\n            </v-list>\n            <!--Firebase から取得したリストを描画（支社）-->\n            <h4>支社</h4>\n            <v-list two-line subheader shaped>\n              <v-subheader>SUBCOMPANYS</v-subheader>\n              <v-list-item-group color=\"primary\">\n                <v-list-item\n                  v-for=\"{\n                    key,\n                    name,\n                    prefecture,\n                    address,\n                    url,\n                    phonenumber,\n                    user_id,\n                    type\n                  } in filteredSubCompanys\"\n                >\n                  <v-list-item-content @click=\"deleteMainCompany(key)\">\n                    <v-list-item-title\n                      style=\"text-align: left;\"\n                      class=\"ml-4\"\n                      v-text=\"prefecture\"\n                    ></v-list-item-title>\n                    <v-list-item-subtitle\n                      style=\"text-align: left;\"\n                      class=\"ml-4\"\n                      v-text=\"name\"\n                    ></v-list-item-subtitle>\n                  </v-list-item-content>\n                </v-list-item>\n              </v-list-item-group>\n            </v-list>\n          </template>\n        </v-container>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\n// firebase モジュール\nimport firebase from \"firebase\";\nimport { mapState, mapMutations } from \"vuex\";\nimport { COMPANY_UPDATE } from \"../store/mutation-types\";\nexport default {\n  name: \"delete\",\n  components: {\n    VueLoading\n  },\n  data() {\n    return {\n      user: {}, // ユーザー情報\n      companys: [], // 取得した本社を入れる配列\n      subCompanys: [],\n      input: \"\", // 入力したメッセージ\n      loading: true\n    };\n  },\n  created() {\n    firebase.auth().onAuthStateChanged(user => {\n      this.user = user ? user : {};\n      const companyData = firebase.database().ref(\"main-company\");\n      const subCompanyData = firebase.database().ref(\"sub-company\");\n      if (user) {\n        this.companys = [];\n        this.subCompanys = [];\n        // company に変更があったときのハンドラを登録\n        companyData.limitToLast(100).on(\"child_added\", this.childAdded);\n        subCompanyData.limitToLast(100).on(\"child_added\", this.subChildAdded);\n      } else {\n        // company に変更があったときのハンドラを解除\n        companyData.limitToLast(100).off(\"child_added\", this.childAdded);\n        subCompanyData.limitToLast(100).off(\"child_added\", this.subChildAdded);\n      }\n    });\n  },\n  mounted() {\n    setTimeout(() => {\n      this.loading = false;\n    }, 1000);\n  },\n  computed: {\n    filteredCompanys: function() {\n      var filterCompanys = [];\n      var user_uid = this.user.uid;\n      for (var i in this.companys) {\n        var company = this.companys[i];\n        if (user_uid == company.user_id) {\n          filterCompanys.push(company);\n        }\n      }\n      return filterCompanys;\n    },\n    filteredSubCompanys: function() {\n      var filterCompanys = [];\n      var user_uid = this.user.uid;\n      for (var i in this.subCompanys) {\n        var company = this.subCompanys[i];\n        if (user_uid == company.user_id) {\n          filterCompanys.push(company);\n        }\n      }\n      return filterCompanys;\n    }\n  },\n  methods: {\n    // スクロール位置を一番下に移動\n    ...mapMutations({\n      COMPANY_UPDATE\n    }),\n    scrollBottom() {\n      this.$nextTick(() => {\n        window.scrollTo(0, document.body.clientHeight);\n      });\n    },\n    // 受け取ったメッセージをcompanysに追加\n    // データベースに新しい要素が追加されると随時呼び出される\n    childAdded(snap) {\n      const company = snap.val();\n      this.companys.push({\n        key: snap.key,\n        name: company.name,\n        prefecture: company.prefecture,\n        address: company.address,\n        url: company.url,\n        phonenumber: company.phonenumber,\n        user_id: company.user_id\n      });\n      this.scrollBottom();\n    },\n    subChildAdded(snap) {\n      const subCompany = snap.val();\n      this.subCompanys.push({\n        key: snap.key,\n        name: subCompany.name,\n        prefecture: subCompany.prefecture,\n        address: subCompany.address,\n        url: subCompany.url,\n        phonenumber: subCompany.phonenumber,\n        main_com_id: subCompany.main_com_id,\n        user_id: subCompany.user_id\n      });\n      this.scrollBottom();\n    },\n    deleteMainCompany(key) {\n      var res = confirm(\"本当に削除しますか?\");\n      if (res == true) {\n        firebase\n          .database()\n          .ref(\"main-company/\" + key)\n          .set({}); //会社情報の削除\n        firebase\n          .database()\n          .ref(\"comment/\" + key)\n          .set({}); //ある会社に対するコメントの削除\n        location.reload();\n      }\n    },\n    deleteSubCompany(key) {\n      var res = confirm(\"本当に削除しますか?\");\n      if (res == true) {\n        firebase\n          .database()\n          .ref(\"sub-company/\" + key)\n          .set({}); //会社情報の削除\n        firebase\n          .database()\n          .ref(\"comment/\" + key)\n          .set({}); //ある会社に対するコメントの削除\n        location.reload();\n      }\n    },\n    sendDetail() {\n      document.location.href = \"./detail\";\n    },\n    companySend(str) {\n      this.COMPANY_UPDATE(str); //会社情報を詳細画面に送る\n      this.sendDetail();\n    }\n  }\n};\n</script>\n"]}]}