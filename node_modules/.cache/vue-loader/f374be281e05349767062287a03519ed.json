{"remainingRequest":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue","mtime":1572928681606},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vuetify-loader/lib/loader.js","mtime":1564062719000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7CmltcG9ydCBmaXJlYmFzZSBmcm9tICJmaXJlYmFzZSI7CmltcG9ydCBObDJiciBmcm9tICJ2dWUtbmwyYnIiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBObDJiciB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiB7fSwgLy8g44Om44O844K244O85oOF5aCxCiAgICAgIGNoYXQ6IFtdLCAvLyDlj5blvpfjgZfjgZ/jg6Hjg4Pjgrvjg7zjgrjjgpLlhaXjgozjgovphY3liJcKICAgICAgaW5wdXQ6ICIiIC8vIOWFpeWKm+OBl+OBn+ODoeODg+OCu+ODvOOCuAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGZpcmViYXNlLmF1dGgoKS5vbkF1dGhTdGF0ZUNoYW5nZWQodXNlciA9PiB7CiAgICAgICAgdGhpcy51c2VyID0gdXNlciA/IHVzZXIgOiB7fTsKICAgICAgICB0aGlzLmNoYXQgPSBbXTsKICAgICAgICBjb25zdCByZWZfbWVzc2FnZSA9IGZpcmViYXNlCiAgICAgICAgICAuZGF0YWJhc2UoKQogICAgICAgICAgLnJlZigiY29tbWVudC8iICsgdGhpcy4kc3RvcmUuc3RhdGUuY29tcGFueS5rZXkpOwogICAgICAgIHJlZl9tZXNzYWdlLmxpbWl0VG9MYXN0KDEwMCkub24oImNoaWxkX2FkZGVkIiwgdGhpcy5jaGlsZEFkZGVkKTsKICAgICAgfSk7CiAgICB9LCAxMDApOyAvL+abtOaWsOOBq+aZgumWk+OBjOOBi+OBi+OCi+OBn+OCgQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKHsKICAgICAgY29tcGFueTogImNvbXBhbnkiCiAgICB9KQogIH0sCiAgbWV0aG9kczogewogICAgY2hpbGRBZGRlZChzbmFwKSB7CiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBzbmFwLnZhbCgpOwogICAgICB0aGlzLmNoYXQucHVzaCh7CiAgICAgICAga2V5OiBzbmFwLmtleSwKICAgICAgICBuYW1lOiBtZXNzYWdlLm5hbWUsCiAgICAgICAgaW1hZ2U6IG1lc3NhZ2UuaW1hZ2UsCiAgICAgICAgbWVzc2FnZTogbWVzc2FnZS5tZXNzYWdlLAogICAgICAgIGNvbXBhbnlrZXk6IG1lc3NhZ2UuY29tcGFueWtleQogICAgICB9KTsKICAgIH0sCiAgICBkb1NlbmQoc2VuZGtleSkgewogICAgICBpZiAodGhpcy51c2VyLnVpZCAmJiB0aGlzLmlucHV0Lmxlbmd0aCkgewogICAgICAgIC8vIGZpcmViYXNlIOOBq+ODoeODg+OCu+ODvOOCuOOCkui/veWKoAogICAgICAgIGZpcmViYXNlCiAgICAgICAgICAuZGF0YWJhc2UoKQogICAgICAgICAgLnJlZigiY29tbWVudC8iICsgc2VuZGtleSkKICAgICAgICAgIC5wdXNoKAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy5pbnB1dCwKICAgICAgICAgICAgICBuYW1lOiB0aGlzLnVzZXIuZGlzcGxheU5hbWUsCiAgICAgICAgICAgICAgaW1hZ2U6IHRoaXMudXNlci5waG90b1VSTCwKICAgICAgICAgICAgICBjb21wYW55a2V5OiBzZW5ka2V5CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICgpID0+IHsKICAgICAgICAgICAgICB0aGlzLmlucHV0ID0gIiI7IC8vIOODleOCqeODvOODoOOCkuepuuOBq+OBmeOCiwogICAgICAgICAgICB9CiAgICAgICAgICApOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"detail\">\n    <h2>詳細ページ</h2>\n    <div>会社名:{{ company.name }}</div>\n    <div>実習場所:{{ company.place }}</div>\n    <div>実習期間:{{ company.day }}</div>\n    <div>感想:{{ company.feel }}</div>\n    <br />\n    <h3>~みんなのコメント~</h3>\n    <!--Firebase から取得したリストを描画（トランジション付き）-->\n    <transition-group name=\"chat\" tag=\"div\" class=\"list content\">\n      <section\n        v-for=\"{ key, name, image, message, companykey } in chat\"\n        :key=\"key\"\n      >\n        <div v-if=\"company.key == companykey\" key=\"chat\" class=\"box11\">\n          <div class=\"item-detail\">\n            <div class=\"item-name\">{{ name }}</div>\n            <div class>\n              {{ message }}\n            </div>\n          </div>\n        </div>\n      </section> </transition-group\n    >\u0010\n\n    <!-- 入力フォーム -->\n    <form action=\"\" @submit.prevent=\"doSend(company.key)\" class=\"form\">\n      <textarea\n        v-model=\"input\"\n        :disabled=\"!user.uid\"\n        placeholder=\"コメントを残す\"\n      ></textarea>\n      <button type=\"submit\" :disabled=\"!user.uid\" class=\"send-button\">\n        Send\n      </button>\n    </form>\n  </div>\n</template>\n<script>\nimport { mapState } from \"vuex\";\nimport firebase from \"firebase\";\nimport Nl2br from \"vue-nl2br\";\nexport default {\n  components: { Nl2br },\n  data() {\n    return {\n      user: {}, // ユーザー情報\n      chat: [], // 取得したメッセージを入れる配列\n      input: \"\" // 入力したメッセージ\n    };\n  },\n  created() {\n    setInterval(() => {\n      firebase.auth().onAuthStateChanged(user => {\n        this.user = user ? user : {};\n        this.chat = [];\n        const ref_message = firebase\n          .database()\n          .ref(\"comment/\" + this.$store.state.company.key);\n        ref_message.limitToLast(100).on(\"child_added\", this.childAdded);\n      });\n    }, 100); //更新に時間がかかるため\n  },\n  computed: {\n    ...mapState({\n      company: \"company\"\n    })\n  },\n  methods: {\n    childAdded(snap) {\n      const message = snap.val();\n      this.chat.push({\n        key: snap.key,\n        name: message.name,\n        image: message.image,\n        message: message.message,\n        companykey: message.companykey\n      });\n    },\n    doSend(sendkey) {\n      if (this.user.uid && this.input.length) {\n        // firebase にメッセージを追加\n        firebase\n          .database()\n          .ref(\"comment/\" + sendkey)\n          .push(\n            {\n              message: this.input,\n              name: this.user.displayName,\n              image: this.user.photoURL,\n              companykey: sendkey\n            },\n            () => {\n              this.input = \"\"; // フォームを空にする\n            }\n          );\n      }\n    }\n  }\n};\n</script>\n"]}]}