{"remainingRequest":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/k17111kk/TechTrain/techTrain_mission/src/views/Detail.vue","mtime":1572916934426},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/k17111kk/TechTrain/techTrain_mission/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7CmltcG9ydCBmaXJlYmFzZSBmcm9tICJmaXJlYmFzZSI7CmltcG9ydCBObDJiciBmcm9tICJ2dWUtbmwyYnIiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogeyBObDJiciB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiB7fSwgLy8g44Om44O844K244O85oOF5aCxCiAgICAgIGNoYXQ6IFtdLCAvLyDlj5blvpfjgZfjgZ/jg6Hjg4Pjgrvjg7zjgrjjgpLlhaXjgozjgovphY3liJcKICAgICAgaW5wdXQ6ICIiIC8vIOWFpeWKm+OBl+OBn+ODoeODg+OCu+ODvOOCuAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgIGZpcmViYXNlLmF1dGgoKS5vbkF1dGhTdGF0ZUNoYW5nZWQodXNlciA9PiB7CiAgICAgICAgdGhpcy51c2VyID0gdXNlciA/IHVzZXIgOiB7fTsKICAgICAgICB0aGlzLmNoYXQgPSBbXTsKICAgICAgICBjb25zdCByZWZfbWVzc2FnZSA9IGZpcmViYXNlCiAgICAgICAgICAuZGF0YWJhc2UoKQogICAgICAgICAgLnJlZigiY29tbWVudC8iICsgdGhpcy4kc3RvcmUuc3RhdGUuY29tcGFueS5rZXkpOwogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLmNvbXBhbnkua2V5KTsKICAgICAgICByZWZfbWVzc2FnZS5saW1pdFRvTGFzdCgxMDApLm9uKCJjaGlsZF9hZGRlZCIsIHRoaXMuY2hpbGRBZGRlZCk7CiAgICAgIH0pOwogICAgfSwgMTAwMCk7CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoewogICAgICBjb21wYW55OiAiY29tcGFueSIKICAgIH0pCiAgfSwKICBtZXRob2RzOiB7CiAgICBjaGlsZEFkZGVkKHNuYXApIHsKICAgICAgY29uc3QgbWVzc2FnZSA9IHNuYXAudmFsKCk7CiAgICAgIHRoaXMuY2hhdC5wdXNoKHsKICAgICAgICBrZXk6IHNuYXAua2V5LAogICAgICAgIG5hbWU6IG1lc3NhZ2UubmFtZSwKICAgICAgICBpbWFnZTogbWVzc2FnZS5pbWFnZSwKICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLm1lc3NhZ2UsCiAgICAgICAgY29tcGFueWtleTogbWVzc2FnZS5jb21wYW55a2V5CiAgICAgIH0pOwogICAgfSwKICAgIGRvU2VuZChzZW5ka2V5KSB7CiAgICAgIGlmICh0aGlzLnVzZXIudWlkICYmIHRoaXMuaW5wdXQubGVuZ3RoKSB7CiAgICAgICAgLy8gZmlyZWJhc2Ug44Gr44Oh44OD44K744O844K444KS6L+95YqgCiAgICAgICAgZmlyZWJhc2UKICAgICAgICAgIC5kYXRhYmFzZSgpCiAgICAgICAgICAucmVmKCJjb21tZW50LyIgKyBzZW5ka2V5KQogICAgICAgICAgLnB1c2goCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmlucHV0LAogICAgICAgICAgICAgIG5hbWU6IHRoaXMudXNlci5kaXNwbGF5TmFtZSwKICAgICAgICAgICAgICBpbWFnZTogdGhpcy51c2VyLnBob3RvVVJMLAogICAgICAgICAgICAgIGNvbXBhbnlrZXk6IHNlbmRrZXkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgKCkgPT4gewogICAgICAgICAgICAgIHRoaXMuaW5wdXQgPSAiIjsgLy8g44OV44Kp44O844Og44KS56m644Gr44GZ44KLCiAgICAgICAgICAgIH0KICAgICAgICAgICk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"detail\">\n    <h2>詳細ページ</h2>\n    <div>会社名:{{ company.name }}</div>\n    <div>実習場所:{{ company.place }}</div>\n    <div>実習期間:{{ company.day }}</div>\n    <div>感想:{{ company.feel }}</div>\n    <br />\n    <h3>~みんなのコメント~</h3>\n    <!--Firebase から取得したリストを描画（トランジション付き）-->\n    <transition-group name=\"chat\" tag=\"div\" class=\"list content\">\n      <section\n        v-for=\"{ key, name, image, message, companykey } in chat\"\n        :key=\"key\"\n      >\n        <div v-if=\"company.key == companykey\" key=\"chat\" class=\"box11\">\n          <div class=\"item-detail\">\n            <div class=\"item-name\">{{ name }}</div>\n            <div class>\n              {{ message }}\n            </div>\n          </div>\n        </div>\n      </section> </transition-group\n    >\u0010\n\n    <!-- 入力フォーム -->\n    <form action=\"\" @submit.prevent=\"doSend(company.key)\" class=\"form\">\n      <textarea\n        v-model=\"input\"\n        :disabled=\"!user.uid\"\n        placeholder=\"コメントを残す\"\n      ></textarea>\n      <button type=\"submit\" :disabled=\"!user.uid\" class=\"send-button\">\n        Send\n      </button>\n    </form>\n  </div>\n</template>\n<script>\nimport { mapState } from \"vuex\";\nimport firebase from \"firebase\";\nimport Nl2br from \"vue-nl2br\";\nexport default {\n  components: { Nl2br },\n  data() {\n    return {\n      user: {}, // ユーザー情報\n      chat: [], // 取得したメッセージを入れる配列\n      input: \"\" // 入力したメッセージ\n    };\n  },\n  created() {\n    setInterval(() => {\n      firebase.auth().onAuthStateChanged(user => {\n        this.user = user ? user : {};\n        this.chat = [];\n        const ref_message = firebase\n          .database()\n          .ref(\"comment/\" + this.$store.state.company.key);\n        console.log(this.$store.state.company.key);\n        ref_message.limitToLast(100).on(\"child_added\", this.childAdded);\n      });\n    }, 1000);\n  },\n  computed: {\n    ...mapState({\n      company: \"company\"\n    })\n  },\n  methods: {\n    childAdded(snap) {\n      const message = snap.val();\n      this.chat.push({\n        key: snap.key,\n        name: message.name,\n        image: message.image,\n        message: message.message,\n        companykey: message.companykey\n      });\n    },\n    doSend(sendkey) {\n      if (this.user.uid && this.input.length) {\n        // firebase にメッセージを追加\n        firebase\n          .database()\n          .ref(\"comment/\" + sendkey)\n          .push(\n            {\n              message: this.input,\n              name: this.user.displayName,\n              image: this.user.photoURL,\n              companykey: sendkey\n            },\n            () => {\n              this.input = \"\"; // フォームを空にする\n            }\n          );\n      }\n    }\n  }\n};\n</script>\n"]}]}